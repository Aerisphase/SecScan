# Модуль Reporter

## Обзор
Модуль `reporter.py` отвечает за генерацию отчетов о результатах сканирования, включая статистику, найденные уязвимости и рекомендации по их устранению.

## Основные компоненты

### Класс Reporter
Основной класс для генерации отчетов о сканировании.

#### Методы:
- `__init__(self)`
  - Инициализация генератора отчетов
  - Настраивает систему логирования

- `generate_report(self, target_url: str, pages_crawled: int, vulnerabilities_found: List[Dict], scan_type: str = "fast", elapsed_time: float = 0.0) -> Dict`
  - Генерация комплексного отчета о сканировании
  - Параметры:
    - `target_url`: URL сканируемого сайта
    - `pages_crawled`: Количество просканированных страниц
    - `vulnerabilities_found`: Список найденных уязвимостей
    - `scan_type`: Тип сканирования (fast/full)
    - `elapsed_time`: Время выполнения сканирования
  - Возвращает словарь с отчетом

- `_generate_recommendations(self, vulnerabilities: List[Dict]) -> List[str]`
  - Генерация рекомендаций по безопасности на основе найденных уязвимостей
  - Параметры:
    - `vulnerabilities`: Список найденных уязвимостей
  - Возвращает список рекомендаций

## Формат отчета

Отчет представляет собой словарь со следующей структурой:

```python
{
    'scan_id': str,  # Уникальный идентификатор сканирования
    'target_url': str,  # URL сканируемого сайта
    'scan_type': str,  # Тип сканирования
    'timestamp': str,  # Время создания отчета
    'elapsed_time': float,  # Время выполнения сканирования
    'stats': {
        'pages_crawled': int,  # Количество просканированных страниц
        'total_vulnerabilities': int,  # Общее количество уязвимостей
        'severity_counts': {  # Количество уязвимостей по уровням серьезности
            'critical': int,
            'high': int,
            'medium': int,
            'low': int
        }
    },
    'vulnerabilities': [  # Список найденных уязвимостей
        {
            'type': str,  # Тип уязвимости
            'url': str,  # URL страницы с уязвимостью
            'severity': str,  # Уровень серьезности
            'details': Dict  # Дополнительные детали
        }
    ],
    'recommendations': [str]  # Список рекомендаций
}
```

## Пример использования

```python
from core.reporter import Reporter

# Создание генератора отчетов
reporter = Reporter()

# Генерация отчета
report = reporter.generate_report(
    target_url='https://example.com',
    pages_crawled=50,
    vulnerabilities_found=[
        {
            'type': 'xss',
            'url': 'https://example.com/search',
            'severity': 'high',
            'details': {
                'parameter': 'q',
                'payload': '<script>alert(1)</script>'
            }
        }
    ],
    scan_type='full',
    elapsed_time=120.5
)

# Вывод результатов
print(f"Найдено уязвимостей: {report['stats']['total_vulnerabilities']}")
for rec in report['recommendations']:
    print(f"Рекомендация: {rec}")
```

## Особенности реализации

1. **Статистика**
   - Подсчет общего количества уязвимостей
   - Распределение по уровням серьезности
   - Время выполнения сканирования

2. **Рекомендации**
   - Группировка уязвимостей по типам
   - Специфические рекомендации для каждого типа
   - Учет количества найденных уязвимостей

3. **Обработка ошибок**
   - Логирование ошибок при генерации отчета
   - Возврат None в случае критических ошибок

## Рекомендации по использованию

1. Используйте различные типы сканирования для получения полной картины:
   - `fast` для быстрой проверки
   - `full` для детального анализа

2. Обрабатывайте рекомендации в порядке приоритета:
   - Сначала критические уязвимости
   - Затем высокие и средние
   - В последнюю очередь низкие

3. Сохраняйте отчеты для последующего анализа:
   - Используйте `scan_id` для идентификации
   - Храните историю сканирований

4. Используйте статистику для оценки эффективности исправлений:
   - Сравнивайте количество уязвимостей между сканированиями
   - Отслеживайте изменение уровней серьезности 