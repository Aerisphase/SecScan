# Модуль Scanner

## Обзор
Модуль `scanner.py` является основным компонентом SecScan, отвечающим за сканирование веб-приложений на наличие уязвимостей. Он координирует работу краулера и специализированных сканеров для различных типов уязвимостей.

## Основные компоненты

### Класс Scanner
Основной класс, реализующий функциональность сканирования.

#### Методы:
- `__init__(self, config: Optional[Dict] = None)`
  - Инициализация сканера с конфигурацией
  - Параметры:
    - `config`: Словарь с настройками сканирования

- `scan(self, target_url: str) -> Optional[Dict]`
  - Основной метод сканирования
  - Параметры:
    - `target_url`: URL-адрес для сканирования
  - Возвращает:
    - Словарь с результатами сканирования или None в случае ошибки

- `scan_page(self, page_data: Dict) -> List[Dict]`
  - Сканирование отдельной страницы
  - Параметры:
    - `page_data`: Данные страницы для сканирования
  - Возвращает:
    - Список найденных уязвимостей

### Вспомогательные функции

#### `setup_logging()`
- Настройка системы логирования
- Создает файл `scan.log` и настраивает вывод в консоль

#### `parse_args()`
- Парсинг аргументов командной строки
- Поддерживаемые аргументы:
  - `--target`: URL для сканирования (обязательный)
  - `--scan-type`: Тип сканирования (fast/full)
  - `--delay`: Задержка между запросами
  - `--max-pages`: Максимальное количество страниц
  - `--user-agent`: Пользовательский User-Agent
  - `--verify-ssl`: Проверка SSL-сертификатов
  - `--proxy`: URL прокси-сервера
  - `--auth`: Учетные данные для базовой аутентификации
  - `--max-retries`: Максимальное количество попыток

#### `analyze_security_headers(headers: Dict[str, str]) -> List[str]`
- Анализ заголовков безопасности
- Проверяет наличие и корректность:
  - X-Frame-Options
  - X-Content-Type-Options
  - X-XSS-Protection
  - Content-Security-Policy
  - Strict-Transport-Security

#### `print_results(results: Dict)`
- Вывод результатов сканирования
- Отображает:
  - Статистику сканирования
  - Рекомендации по безопасности
  - Найденные уязвимости

## Формат результатов

Результаты сканирования возвращаются в виде словаря со следующей структурой:

```python
{
    'stats': {
        'pages_crawled': int,
        'links_found': int,
        'forms_found': int
    },
    'vulnerabilities': [
        {
            'type': str,
            'url': str,
            'param': str,
            'payload': str,
            'evidence': str,
            'severity': str
        }
    ],
    'security_recommendations': [str],
    'security_headers': Dict[str, str]
}
```

## Пример использования

```python
from core.scanner import Scanner

# Создание экземпляра сканера
scanner = Scanner({
    'scan_type': 'full',
    'delay': 1.0,
    'max_pages': 50,
    'verify_ssl': True
})

# Запуск сканирования
results = scanner.scan('https://example.com')

# Обработка результатов
if results:
    print(f"Найдено {len(results['vulnerabilities'])} уязвимостей")
```

## Обработка ошибок

Сканер обрабатывает следующие типы ошибок:
- Ошибки сети
- Ошибки парсинга
- Ошибки сканирования
- Прерывание пользователем

Все ошибки логируются в файл `scan.log` и выводятся в консоль.

## Рекомендации по использованию

1. Настройте задержку между запросами для избежания блокировки
2. Используйте прокси для распределения нагрузки
3. Настройте User-Agent для имитации реального браузера
4. Проверяйте результаты на наличие ложных срабатываний 